(function(){"use strict";var e={6585:function(e,t,r){var o=r(3751),a=r(641);const u={class:"app"};function n(e,t,r,o,n,s){const l=(0,a.g2)("ProductList"),c=(0,a.g2)("TransferForm");return(0,a.uX)(),(0,a.CE)("div",u,[t[0]||(t[0]=(0,a.Lk)("h1",null,"商品管理系统",-1)),(0,a.bF)(l,{products:o.products,warehouses:o.warehouses,onDeleteProduct:o.deleteProduct,onTransferProduct:o.openTransferForm},null,8,["products","warehouses","onDeleteProduct","onTransferProduct"]),o.transferFormVisible?((0,a.uX)(),(0,a.Wv)(c,{key:0,product:o.productToTransfer,warehouses:o.warehouses,onTransfer:o.transferProduct,onCancel:o.cancelTransfer},null,8,["product","warehouses","onTransfer","onCancel"])):(0,a.Q3)("",!0)])}var s=r(953),l=r(4335),c=r(33);const d={class:"app"},i={key:0,class:"error-message"},p={key:1,class:"loading"},h={key:2,class:"warehouse-select"},f=["value"],v={key:3,class:"product-list"},k={class:"product-table"},w=["onClick"],b=["onClick"],m={key:4,class:"add-product"},y={class:"input-group"},L={class:"input-group"},g={class:"input-group"},C={key:5,class:"modal"},I={class:"modal-content"},P=["value"];function T(e,t,r,u,n,s){return(0,a.uX)(),(0,a.CE)("div",d,[t[18]||(t[18]=(0,a.Lk)("h1",{class:"title"},"商品管理系统",-1)),u.errorMessage?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("span",null,(0,c.v_)(u.errorMessage),1)])):(0,a.Q3)("",!0),u.loading?((0,a.uX)(),(0,a.CE)("div",p,t[9]||(t[9]=[(0,a.Lk)("span",null,"加载中...",-1),(0,a.Lk)("div",{class:"spinner"},null,-1)]))):(0,a.Q3)("",!0),u.loading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",h,[t[10]||(t[10]=(0,a.Lk)("label",{for:"warehouse-select"},"选择仓库:",-1)),(0,a.bo)((0,a.Lk)("select",{id:"warehouse-select","onUpdate:modelValue":t[0]||(t[0]=e=>u.selectedWarehouseId=e),onChange:t[1]||(t[1]=(...e)=>u.fetchProducts&&u.fetchProducts(...e))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(u.warehouses,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,c.v_)(e.name),9,f)))),128))],544),[[o.u1,u.selectedWarehouseId]])])),!u.loading&&u.products.length>0?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("table",k,[t[11]||(t[11]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"商品名称"),(0,a.Lk)("th",null,"供应商"),(0,a.Lk)("th",null,"操作")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(u.products,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,(0,c.v_)(e.name),1),(0,a.Lk)("td",null,(0,c.v_)(e.supplier),1),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"delete-btn",onClick:t=>u.deleteProduct(e.id)},"删除",8,w),(0,a.Lk)("button",{class:"transfer-btn",onClick:t=>u.selectTransferWarehouse(e)},"转移仓库",8,b)])])))),128))])])])):(0,a.Q3)("",!0),u.loading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",m,[t[16]||(t[16]=(0,a.Lk)("h3",null,"添加新商品",-1)),(0,a.Lk)("form",{onSubmit:t[5]||(t[5]=(0,o.D$)(((...e)=>u.addProduct&&u.addProduct(...e)),["prevent"])),class:"add-product-form"},[(0,a.Lk)("div",y,[t[12]||(t[12]=(0,a.Lk)("label",{for:"product-name"},"商品名称:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"product-name","onUpdate:modelValue":t[2]||(t[2]=e=>u.newProduct.name=e),required:""},null,512),[[o.Jo,u.newProduct.name]])]),(0,a.Lk)("div",L,[t[13]||(t[13]=(0,a.Lk)("label",{for:"product-supplier"},"供应商:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"product-supplier","onUpdate:modelValue":t[3]||(t[3]=e=>u.newProduct.supplier=e),required:""},null,512),[[o.Jo,u.newProduct.supplier]])]),(0,a.Lk)("div",g,[t[14]||(t[14]=(0,a.Lk)("label",{for:"product-warehouse-id"},"仓库ID:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"product-warehouse-id","onUpdate:modelValue":t[4]||(t[4]=e=>u.newProduct.warehouseId=e),required:""},null,512),[[o.Jo,u.newProduct.warehouseId]])]),t[15]||(t[15]=(0,a.Lk)("button",{type:"submit",class:"submit-btn"},"添加商品",-1))],32)])),u.showTransferModal?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.Lk)("div",I,[t[17]||(t[17]=(0,a.Lk)("h3",null,"选择目标仓库",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>u.transferWarehouseId=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(u.warehouses,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,c.v_)(e.name),9,P)))),128))],512),[[o.u1,u.transferWarehouseId]]),(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>u.transferProduct&&u.transferProduct(...e)),class:"transfer-btn"},"确认转移"),(0,a.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>u.closeTransferModal&&u.closeTransferModal(...e)),class:"cancel-btn"},"取消")])])):(0,a.Q3)("",!0)])}r(8992),r(2577);var E={name:"App",setup(){const e=(0,s.KR)([]),t=(0,s.KR)([]),r=(0,s.KR)(2),o=(0,s.KR)(!1),u=(0,s.KR)(""),n=(0,s.KR)({name:"",supplier:"",warehouseId:null}),c=(0,s.KR)(!1),d=(0,s.KR)(null),i=(0,s.KR)(null),p=async()=>{o.value=!0,u.value="";try{const t=r.value,o=await l.A.get(`http://101.200.120.14:9090/api/products/${t}/products`);200===o.status?e.value=o.data:u.value="获取商品列表失败，服务器返回错误"}catch(t){console.error("获取商品列表失败",t),u.value="获取商品列表失败，请稍后再试"}finally{o.value=!1}},h=async()=>{try{const e=await l.A.get("http://101.200.120.14:9090/api/warehouses/all");200===e.status&&(t.value=e.data)}catch(e){console.error("获取仓库列表失败",e)}},f=e=>{const r=t.value.find((t=>t.id===e));return r?r.name:"未知仓库"},v=async()=>{if(n.value.name&&n.value.supplier&&n.value.warehouseId)try{const e=await l.A.post("http://101.200.120.14:9090/api/products/add",n.value);201===e.status?(n.value.name="",n.value.supplier="",n.value.warehouseId=null,p()):u.value="添加商品失败"}catch(e){console.error("添加商品失败",e),u.value="添加商品失败，请稍后再试"}else u.value="请填写所有字段"},k=async e=>{try{const t=await l.A.delete(`http://101.200.120.14:9090/api/products/${e}`);200===t.status?p():u.value="删除商品失败"}catch(t){console.error("删除商品失败",t),u.value="删除商品失败，请稍后再试"}},w=e=>{i.value=e,d.value=e.warehouseId,c.value=!0},b=()=>{c.value=!1},m=async()=>{if(d.value&&d.value!==i.value.warehouseId)try{const e=await l.A.put(`http://101.200.120.14:9090/api/products/transfer/${i.value.id}?newWarehouseId=${d.value}`);200===e.status?(p(),b()):u.value="转移仓库失败"}catch(e){console.error("转移仓库失败",e),u.value="转移仓库失败，请稍后再试"}else u.value="请选择不同的目标仓库"};return(0,a.sV)((()=>{h(),p()})),{products:e,warehouses:t,selectedWarehouseId:r,loading:o,errorMessage:u,newProduct:n,showTransferModal:c,transferWarehouseId:d,productToTransfer:i,fetchProducts:p,addProduct:v,deleteProduct:k,selectTransferWarehouse:w,closeTransferModal:b,transferProduct:m,getWarehouseName:f}}},X=r(6262);const _=(0,X.A)(E,[["render",T],["__scopeId","data-v-952772da"]]);var K=_;const A={key:0,class:"transfer-form"},W={class:"input-group"},O=["value"];function R(e,t,r,u,n,s){return r.product?((0,a.uX)(),(0,a.CE)("div",A,[t[5]||(t[5]=(0,a.Lk)("h3",null,"转移商品到新仓库",-1)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>s.onTransfer&&s.onTransfer(...e)),["prevent"]))},[(0,a.Lk)("div",W,[t[3]||(t[3]=(0,a.Lk)("label",{for:"new-warehouse"},"选择目标仓库:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedWarehouseId=e),required:""},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.warehouses,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,c.v_)(e.name),9,O)))),128))],512),[[o.u1,n.selectedWarehouseId]])]),t[4]||(t[4]=(0,a.Lk)("button",{type:"submit"},"转移",-1)),(0,a.Lk)("button",{type:"button",onClick:t[1]||(t[1]=(...e)=>s.onCancel&&s.onCancel(...e))},"取消")],32)])):(0,a.Q3)("",!0)}var F={props:{product:Object,warehouses:Array},data(){return{selectedWarehouseId:this.product?.warehouseId||null}},methods:{onTransfer(){this.$emit("transfer",{productId:this.product.id,warehouseId:this.selectedWarehouseId})},onCancel(){this.$emit("cancel")}}};const M=(0,X.A)(F,[["render",R],["__scopeId","data-v-2b3a0e64"]]);var V=M,$={components:{ProductList:K,TransferForm:V},setup(){const e=(0,s.KR)([]),t=(0,s.KR)([]),r=(0,s.KR)(!1),o=(0,s.KR)(null),u=async()=>{try{const t=await l.A.get("http://localhost:8081/api/products");200===t.status&&(e.value=t.data)}catch(t){console.error("获取商品列表失败",t)}},n=async()=>{try{const e=await l.A.get("http://localhost:8081/api/warehouses");200===e.status&&(t.value=e.data)}catch(e){console.error("获取仓库列表失败",e)}},c=async e=>{try{const t=await l.A.delete(`http://localhost:8081/api/products/${e}`);200===t.status&&u()}catch(t){console.error("删除商品失败",t)}},d=e=>{o.value=e,r.value=!0},i=()=>{r.value=!1,o.value=null},p=async({productId:e,warehouseId:t})=>{try{const r=await l.A.put(`http://localhost:8081/api/products/transfer/${e}`,{warehouseId:t});200===r.status&&(u(),i())}catch(r){console.error("转移商品失败",r)}};return(0,a.sV)((()=>{u(),n()})),{products:e,warehouses:t,transferFormVisible:r,productToTransfer:o,deleteProduct:c,openTransferForm:d,cancelTransfer:i,transferProduct:p}}};const j=(0,X.A)($,[["render",n],["__scopeId","data-v-434fc584"]]);var Q=j,x=r(5220);const S=[{path:"/",name:"home",component:Q}],U=(0,x.aE)({history:(0,x.LA)("/"),routes:S});var D=U;(0,o.Ef)(Q).use(D).mount("#app")}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var u=t[o]={exports:{}};return e[o].call(u.exports,u,u.exports,r),u.exports}r.m=e,function(){var e=[];r.O=function(t,o,a,u){if(!o){var n=1/0;for(d=0;d<e.length;d++){o=e[d][0],a=e[d][1],u=e[d][2];for(var s=!0,l=0;l<o.length;l++)(!1&u||n>=u)&&Object.keys(r.O).every((function(e){return r.O[e](o[l])}))?o.splice(l--,1):(s=!1,u<n&&(n=u));if(s){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}u=u||0;for(var d=e.length;d>0&&e[d-1][2]>u;d--)e[d]=e[d-1];e[d]=[o,a,u]}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,u,n=o[0],s=o[1],l=o[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(l)var d=l(r)}for(t&&t(o);c<n.length;c++)u=n[c],r.o(e,u)&&e[u]&&e[u][0](),e[u]=0;return r.O(d)},o=self["webpackChunkmy_vue_app1"]=self["webpackChunkmy_vue_app1"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[504],(function(){return r(6585)}));o=r.O(o)})();
//# sourceMappingURL=app.85a77c9e.js.map